<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8">
<title>Login & G·ª≠i Item & Add Coin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  font-family: Arial, Helvetica, sans-serif;
  background: #f6f0f6;
  overflow: auto;
}
.container {
  width: 95%;
  max-width: 700px;
  max-height: 95%;
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.12);
  padding: 20px;
  margin: 20px auto;
  display: flex;
  flex-direction: column;
  align-items: center;
}
h1 { color: #b91c57; font-size: 36px; text-align: center; margin-bottom: 16px; }
.sub { color: #666; margin-bottom: 20px; text-align: center; }
.row { width: 100%; display: flex; justify-content: center; gap: 16px; flex-wrap: wrap; margin-bottom: 16px; }
input[type="text"], input[type="password"], input[type="number"] {
  width: 40%; min-width: 180px; padding: 20px; font-size: 20px;
  border-radius: 12px; border: 2px solid #eee; text-align: center; box-sizing: border-box;
}
button {
  padding: 20px; font-size: 22px; font-weight: 700; border: none;
  border-radius: 12px; cursor: pointer; width: 45%; min-width: 180px;
  background: #c2185b; color: #fff;
}
button.secondary { background: #555; width: 40%; }
hr { width: 90%; border: none; border-top: 1px solid #eee; margin: 20px 0; }
small.note { color: #888; text-align: center; display: block; margin-top: 8px; }
@media(max-width:600px){
  input[type="text"], input[type="password"], input[type="number"], button {
    width: 90%; margin-top: 10px;
  }
}
</style>
</head>
<body>
<div class="container">
<h1>Login & G·ª≠i Item & Add Coin</h1>
<div class="sub">Nh·∫≠p username/password ƒë·ªÉ login ‚Üí l∆∞u cookie ‚Üí d√πng cookie g·ª≠i Item ho·∫∑c ADD COIN</div>

<!-- Login -->
<div class="row">
<input type="text" id="username" placeholder="Username">
<input type="password" id="password" placeholder="Password">
</div>
<div class="row">
<button onclick="loginAndSaveCookie()">üîë Login & L∆∞u Cookie</button>
<button class="secondary" onclick="logout()">üö™ Logout</button>
</div>
<small class="note">B·∫°n ƒëang ƒëƒÉng nh·∫≠p t√†i kho·∫£n: <span id="cookiePreview">Ch∆∞a ƒëƒÉng nh·∫≠p</span></small>

<hr>

<!-- Send Item -->
<div class="row">
<input type="text" id="reward" placeholder="Nh·∫≠p ID ITEM">
<input type="number" id="quantity" placeholder="S·ªë l∆∞·ª£ng" min="1">
</div>
<div class="row">
<button onclick="sendItem()">üöÄ G·ª≠i Item</button>
</div>

<hr>

<!-- Add Coin -->
<div class="row">
<input type="number" id="addAmount" placeholder="Nh·∫≠p s·ªë coin (amount)" min="1">
<button onclick="addCoin()">‚ûï ADD COIN</button>
</div>
<small class="note">ADD COIN s·∫Ω g·ª≠i type=Tanthu & amount t·ªõi server g·ªëc.</small>

</div>

<script>
const LOGIN_API = "https://<your-vercel>.vercel.app/api/login"; // proxy login
const ACTION_API = "https://<your-vercel>.vercel.app/api/proxy"; // proxy send item/add coin

window.addEventListener('load', ()=>updateCookiePreview());
function updateCookiePreview(){
  const username = localStorage.getItem('username') || '';
  document.getElementById('cookiePreview').textContent = username || "Ch∆∞a ƒëƒÉng nh·∫≠p";
}
function logout(){
  localStorage.removeItem('cookie');
  localStorage.removeItem('username');
  Swal.fire('ƒê√£ ƒëƒÉng xu·∫•t','B·∫°n ƒë√£ ƒëƒÉng xu·∫•t','success');
  updateCookiePreview();
}

// Login
async function loginAndSaveCookie(){
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value.trim();
  if(!username || !password){ Swal.fire('Thi·∫øu d·ªØ li·ªáu','Nh·∫≠p username/password','warning'); return; }

  try{
    const res = await fetch(LOGIN_API,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({ username, password })
    });
    const data = await res.json();
    if(data && data.cookie){
      localStorage.setItem('cookie', data.cookie);
      localStorage.setItem('username', username);
      Swal.fire('ƒêƒÉng nh·∫≠p th√†nh c√¥ng','Cookie ƒë√£ l∆∞u','success');
      updateCookiePreview();
    }else{
      Swal.fire('ƒêƒÉng nh·∫≠p th·∫•t b·∫°i','Ki·ªÉm tra username/password','error');
    }
  }catch(err){
    Swal.fire('L·ªói','Kh√¥ng th·ªÉ login: '+err.message,'error');
  }
}

// G·ª≠i Item
async function sendItem(){
  const cookie = localStorage.getItem('cookie')||"";
  const reward = document.getElementById('reward').value.trim();
  const quantity = document.getElementById('quantity').value.trim();
  if(!cookie){ Swal.fire('Ch∆∞a login','B·∫°n c·∫ßn login','warning'); return; }
  if(!reward || !quantity){ Swal.fire('Thi·∫øu d·ªØ li·ªáu','Nh·∫≠p reward v√† quantity','warning'); return; }

  try{
    const res = await fetch(ACTION_API,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({ cookie, params:{ type:"spin", reward, quantity } })
    });
    const data = await res.json().catch(()=>null);
    Swal.fire('G·ª≠i Item', data && data.message ? data.message : "ƒê√£ g·ª≠i item", (data && data.ok)?'success':'error');
    document.getElementById('reward').value="";
    document.getElementById('quantity').value="";
  }catch(err){
    Swal.fire('L·ªói','G·ª≠i item th·∫•t b·∫°i: '+err.message,'error');
  }
}

// Add Coin
async function addCoin(){
  const cookie = localStorage.getItem('cookie')||"";
  const amount = document.getElementById('addAmount').value.trim();
  if(!cookie){ Swal.fire('Ch∆∞a login','B·∫°n c·∫ßn login','warning'); return; }
  if(!amount){ Swal.fire('Thi·∫øu d·ªØ li·ªáu','Nh·∫≠p s·ªë coin','warning'); return; }

  try{
    const res = await fetch(ACTION_API,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({ cookie, params:{ type:"Tanthu", amount } })
    });
    const data = await res.json().catch(()=>null);
    Swal.fire('ADD COIN', data && data.message ? data.message : "ƒê√£ g·ª≠i ADD COIN", (data && data.ok)?'success':'error');
    document.getElementById('addAmount').value="";
  }catch(err){
    Swal.fire('L·ªói','ADD COIN th·∫•t b·∫°i: '+err.message,'error');
  }
}
</script>
</body>
</html>
