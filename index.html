<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<title>Login & G·ª≠i Item & Add Coin</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
html,body{
  height:100%; margin:0; padding:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#f6f0f6;
  display:flex; align-items:center; justify-content:center;
  overflow:auto;
}
.container{
  width:95%; max-width:700px; min-height:600px;
  background:#fff; border-radius:14px;
  box-shadow:0 8px 30px rgba(0,0,0,0.12);
  padding:28px; box-sizing:border-box;
  display:flex; flex-direction:column;
  align-items:center; justify-content:flex-start;
  margin-top:20px; margin-bottom:20px;
}
h1{ margin:0 0 12px 0; color:#b91c57; font-size:28px; text-align:center;}
.sub { color:#666; margin-bottom:18px; text-align:center; }
.row { width:100%; display:flex; gap:12px; justify-content:center; align-items:center; flex-wrap:wrap; margin-bottom:12px;}
input[type="text"], input[type="password"], input[type="number"]{
  width:calc(45% - 12px); min-width:180px;
  padding:16px; font-size:18px; border:2px solid #eee;
  border-radius:10px; text-align:center; box-sizing:border-box;
}
button{
  background:#c2185b; color:white; border:none; padding:16px;
  border-radius:10px; cursor:pointer; font-size:18px; font-weight:700;
  width:calc(50% - 12px); min-width:180px;
}
button.secondary{ background:#555; width:calc(40% - 12px); }
hr { width:90%; border:none; border-top:1px solid #eee; margin:18px 0; }
small.note { color:#888; display:block; text-align:center; margin-top:8px; }
@media (max-width:520px){
  input[type="text"], input[type="password"], input[type="number"]{ width:90%; }
  button{ width:90%; margin-top:8px; }
}
</style>
</head>
<body>
<div class="container">
<h1>Login & G·ª≠i Item & Add Coin</h1>
<div class="sub">Nh·∫≠p t√†i kho·∫£n, password, ID ITEM ho·∫∑c s·ªë coin ƒë·ªÉ g·ª≠i. M·ªçi d·ªØ li·ªáu s·∫Ω kh√¥ng ƒë∆∞·ª£c l∆∞u.</div>

<!-- LOGIN -->
<div class="row">
<input type="text" id="username" placeholder="Username">
<input type="password" id="password" placeholder="Password">
</div>
<div class="row">
<button onclick="loginAndSend()">üîë Login & G·ª≠i</button>
</div>

<hr>

<!-- G·ª¨I ITEM -->
<div class="row">
<input type="text" id="reward" placeholder="Nh·∫≠p ID ITEM">
<input type="number" id="quantity" placeholder="S·ªë l∆∞·ª£ng" min="1">
</div>
<div class="row">
<button onclick="sendItem()">üöÄ G·ª≠i Item</button>
</div>

<hr>

<!-- ADD COIN -->
<div class="row">
<input type="number" id="coinAmount" placeholder="S·ªë l∆∞·ª£ng coin" min="1">
<button onclick="addCoin()">‚ûï ADD COIN</button>
</div>

</div>

<script>
const VERCEL_BASE = "https://bug-blush.vercel.app"; 
const LOGIN_API = VERCEL_BASE + "/api/login";
const SEND_API  = VERCEL_BASE + "/api/proxy";

// Login & l·∫•y cookie r·ªìi tr·∫£ v·ªÅ ngay, kh√¥ng l∆∞u
async function loginAndSend(){
  const username=document.getElementById('username').value.trim();
  const password=document.getElementById('password').value.trim();
  if(!username || !password){ Swal.fire('Thi·∫øu d·ªØ li·ªáu','Vui l√≤ng nh·∫≠p username v√† password','warning'); return; }
  try{
    const res=await fetch(LOGIN_API,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({username,password})
    });
    const data=await res.json();
    if(data && data.cookie && data.cookie.length){
      Swal.fire('Login th√†nh c√¥ng','B·∫°n c√≥ th·ªÉ g·ª≠i item ho·∫∑c add coin ngay.','success');
    } else {
      Swal.fire('Kh√¥ng l·∫•y ƒë∆∞·ª£c cookie','Server tr·∫£: '+JSON.stringify(data),'error');
    }
  }catch(err){
    Swal.fire('L·ªói k·∫øt n·ªëi','Kh√¥ng th·ªÉ g·ªçi API login: '+err.message,'error');
    console.error(err);
  }
}

// G·ª≠i Item
async function sendItem(){
  const username=document.getElementById('username').value.trim();
  const password=document.getElementById('password').value.trim();
  const reward=document.getElementById('reward').value.trim();
  const quantity=document.getElementById('quantity').value.trim();
  if(!username || !password || !reward || !quantity){
    Swal.fire('Thi·∫øu d·ªØ li·ªáu','ƒêi·ªÅn ƒë·∫ßy ƒë·ªß username/password/reward/quantity','warning'); return;
  }
  try{
    const loginRes=await fetch(LOGIN_API,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({username,password})
    });
    const loginData=await loginRes.json();
    const cookie=loginData.cookie || "";
    await fetch(SEND_API,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({cookie,reward,quantity})
    });
    Swal.fire('Th√†nh c√¥ng','ƒê√£ g·ª≠i item. Trang s·∫Ω reload','success').then(()=>location.reload());
  }catch(err){
    Swal.fire('L·ªói','G·ª≠i item th·∫•t b·∫°i: '+err.message,'error');
    console.error(err);
  }
}

// ADD COIN
async function addCoin(){
  const username=document.getElementById('username').value.trim();
  const password=document.getElementById('password').value.trim();
  const amount=document.getElementById('coinAmount').value.trim();
  if(!username || !password || !amount){
    Swal.fire('Thi·∫øu d·ªØ li·ªáu','ƒêi·ªÅn ƒë·∫ßy ƒë·ªß username/password/amount','warning'); return;
  }
  try{
    const loginRes=await fetch(LOGIN_API,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({username,password})
    });
    const loginData=await loginRes.json();
    const cookie=loginData.cookie || "";
    await fetch(SEND_API,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({cookie, params:{type:"Tanthu", amount}})
    });
    Swal.fire('Th√†nh c√¥ng','ƒê√£ g·ª≠i coin. Trang s·∫Ω reload','success').then(()=>location.reload());
  }catch(err){
    Swal.fire('L·ªói','ADD COIN th·∫•t b·∫°i: '+err.message,'error');
    console.error(err);
  }
}
</script>
</body>
</html>
