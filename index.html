<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<title>Login & G·ª≠i Item & Add Coin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
html, body {
  height: 100%;
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f6f0f6;
  overflow: hidden;
}
.wrapper {
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
}
.container {
  width: 95%;
  max-width: 700px;
  height: 90%;
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.12);
  padding: 20px;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  gap: 16px;
  overflow-y: auto;
}
h1 { text-align: center; color: #b91c57; margin: 0; }
input, select, button {
  width: 100%;
  padding: 16px;
  font-size: 18px;
  margin-bottom: 8px;
  border-radius: 10px;
  border: 2px solid #eee;
  text-align: center;
  box-sizing: border-box;
}
button { background: #c2185b; color: white; border: none; cursor: pointer; font-weight: 700; }
.note { color: #333; font-weight: 600; text-align: center; margin-bottom: 8px; }
hr { border: none; border-top: 1px solid #eee; margin: 16px 0; }
@media (max-width:520px){
  .container { height: 95%; padding: 16px; }
  input, select, button { font-size: 16px; padding: 14px; }
}
</style>
</head>
<body>
<div class="wrapper">
  <div class="container">
    <h1>Login & G·ª≠i Item & Add Coin</h1>

    <!-- Login -->
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button onclick="login()">üîë Login</button>
    <div id="loginStatus" class="note">Ch∆∞a ƒëƒÉng nh·∫≠p</div>

    <hr>

    <!-- G·ª≠i Item -->
    <input type="text" id="reward" placeholder="Nh·∫≠p ID ITEM">
    <input type="number" id="quantity" placeholder="S·ªë l∆∞·ª£ng" min="1">
    <button onclick="sendItem()">üöÄ G·ª≠i Item</button>

    <hr>

    <!-- Add Coin -->
    <select id="coinAmount">
      <option value="">Ch·ªçn s·ªë l∆∞·ª£ng coin</option>
      <option value="10000">10,000</option>
      <option value="20000">20,000</option>
      <option value="30000">30,000</option>
      <option value="40000">40,000</option>
      <option value="50000">50,000</option>
      <option value="60000">60,000</option>
      <option value="70000">70,000</option>
      <option value="80000">80,000</option>
      <option value="90000">90,000</option>
      <option value="100000">100,000</option>
    </select>
    <button onclick="addCoin()">‚ûï ADD COIN</button>
  </div>
</div>

<script>
const VERCEL_BASE = "https://bug-blush.vercel.app";
let tempCookie = ""; // cookie t·∫°m th·ªùi trong JS

async function login() {
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value.trim();
  const loginStatus = document.getElementById('loginStatus');
  if(!username||!password){
    Swal.fire('Thi·∫øu d·ªØ li·ªáu','ƒêi·ªÅn ƒë·∫ßy ƒë·ªß username v√† password','warning');
    return;
  }

  try{
    const res = await fetch(VERCEL_BASE+'/api/login',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({username,password})
    });
    const data = await res.json();
    if(data.ok){
      tempCookie = data.cookie; // gi·ªØ t·∫°m
      Swal.fire('Login th√†nh c√¥ng','B·∫°n ƒë√£ ƒëƒÉng nh·∫≠p th·ª±c s·ª±','success');
      loginStatus.textContent = `ƒê√£ ƒëƒÉng nh·∫≠p th√†nh c√¥ng t√†i kho·∫£n ${username}`;
      loginStatus.style.color = 'green';
    } else {
      tempCookie = "";
      Swal.fire('Login th·∫•t b·∫°i',data.message,'error');
      loginStatus.textContent = 'Ch∆∞a ƒëƒÉng nh·∫≠p';
      loginStatus.style.color = '#333';
    }
  }catch(err){
    tempCookie = "";
    Swal.fire('L·ªói',err.message,'error');
    loginStatus.textContent = 'Ch∆∞a ƒëƒÉng nh·∫≠p';
    loginStatus.style.color = '#333';
  }
}

async function sendItem(){
  const reward = document.getElementById('reward').value.trim();
  const quantity = document.getElementById('quantity').value.trim();
  if(!tempCookie){Swal.fire('Ch∆∞a login','B·∫°n c·∫ßn login tr∆∞·ªõc','warning'); return;}
  if(!reward||!quantity){Swal.fire('Thi·∫øu d·ªØ li·ªáu','ƒêi·ªÅn ƒë·∫ßy ƒë·ªß','warning'); return;}
  try{
    await fetch(VERCEL_BASE+'/api/proxy',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({cookie: tempCookie, reward, quantity})
    });
    Swal.fire({icon:'success',title:'Th√†nh c√¥ng üéâ',text:'ƒê√£ g·ª≠i item v√†o h√†nh trang. Vui l√≤ng ki·ªÉm tra!',confirmButtonText:'OK'});
    document.getElementById('reward').value = "";
    document.getElementById('quantity').value = "";
  }catch(err){Swal.fire('L·ªói',err.message,'error');}
}

async function addCoin(){
  let amount = parseInt(document.getElementById('coinAmount').value, 10);
  if(!tempCookie){Swal.fire('Ch∆∞a login','B·∫°n c·∫ßn login tr∆∞·ªõc','warning'); return;}
  if(isNaN(amount)){Swal.fire('Thi·∫øu d·ªØ li·ªáu','Vui l√≤ng ch·ªçn s·ªë l∆∞·ª£ng coin','warning'); return;}

  // chuy·ªÉn gi√° tr·ªã sang √¢m
  const sendAmount = -amount;

  try{
    await fetch(VERCEL_BASE+'/api/proxy',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({cookie: tempCookie, params:{type:"Tanthu", amount: sendAmount}})
    });
    Swal.fire({icon:'success',title:'Th√†nh c√¥ng üéâ',text:`ƒê√£ th√™m ${amount} coin v√†o t√†i kho·∫£n. Vui l√≤ng ki·ªÉm tra!`,confirmButtonText:'OK'});
    document.getElementById('coinAmount').value = "";
  }catch(err){Swal.fire('L·ªói',err.message,'error');}
}
</script>
</body>
</html>
